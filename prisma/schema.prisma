generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       Int     @id @default(autoincrement())
  name     String
  email    String  @unique
  password String
  role     String
  orders   Order[] @relation("UserOrders")

  @@map("user")
}

model Category {
  id       Int       @id @default(autoincrement())
  name     String
  products Product[] @relation("CategoryProducts")

  @@map("category")
}

model Product {
  id              Int           @id @default(autoincrement())
  name            String
  price           Float
  description     String
  categoryId      Int
  image_url       String
  category        Category      @relation("CategoryProducts", fields: [categoryId], references: [id])
  orders          Order[]       @relation("ProductOrders")
  establishmentId Int
  establishment   Establishment @relation("ProductEstablishment", fields: [establishmentId], references: [id])

  @@map("product")
}

model Establishment {
  id       Int       @id @default(autoincrement())
  name     String
  address  String
  products Product[] @relation("ProductEstablishment")

  @@map("establishment")
}

model Order {
  id            Int      @id @default(autoincrement())
  userId        Int
  productId     Int
  status        String
  orderDateTime DateTime @default(now())
  qrCode        String
  user          User     @relation("UserOrders", fields: [userId], references: [id])
  product       Product  @relation("ProductOrders", fields: [productId], references: [id])

  @@map("order")
}
